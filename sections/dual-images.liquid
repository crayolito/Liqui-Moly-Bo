{% comment %}
  =====================================================
  SECCIÓN: Imágenes Duales (Dos Imágenes Responsivas)
  PROPÓSITO: Mostrar 2 imágenes con enlaces opcionales
  LAYOUT: Row en desktop/tablet, Column solo en mobile
  AUTOR: Desarrollador Shopify
  ÚLTIMA ACTUALIZACIÓN: 2024-10-15
  =====================================================
{% endcomment %}

{%- liquid
  # Configuración de la sección
  assign section_id = 'imagenes-duales-' | append: section.id

  # Clase de contenedor: full-width o container limitado
  if section.settings.full_width
    assign container_class = 'contenedor-imagenes-duales contenedor-imagenes-duales--full-width'
  else
    assign container_class = 'container contenedor-imagenes-duales'
  endif

  # Configuraciones de espaciado desde el admin
  assign padding_superior = section.settings.padding_superior | default: 40
  assign padding_inferior = section.settings.padding_inferior | default: 40
  assign espacio_entre_imagenes = section.settings.espacio_entre_imagenes | default: 20

  # Altura configurable
  assign altura_desktop = section.settings.altura_desktop | default: 150
  assign altura_mobile = section.settings.altura_mobile | default: 300
-%}

<section
  id="{{ section_id }}"
  class="seccion-imagenes-duales"
  data-section-id="{{ section.id }}"
  style="
    --padding-superior: {{ padding_superior }}px;
    --padding-inferior: {{ padding_inferior }}px;
    --espacio-imagenes: {{ espacio_entre_imagenes }}px;
    --altura-desktop: {{ altura_desktop }}px;
    --altura-mobile: {{ altura_mobile }}px;
  "
>
  <div class="{{ container_class }}">
    <div class="imagenes-wrapper">
      {% comment %} IMAGEN 1 {% endcomment %}
      <div class="item-imagen item-imagen--1">
        {%- liquid
          # Imagen para desktop/tablet
          assign imagen_desktop = section.settings.imagen_1_desktop
          # Imagen para mobile
          assign imagen_mobile = section.settings.imagen_1_mobile
          # Fallback: si no hay mobile, usa desktop
          unless imagen_mobile
            assign imagen_mobile = imagen_desktop
          endunless

          # Enlace opcional
          assign enlace_1 = section.settings.enlace_1
          assign texto_enlace_1 = section.settings.texto_enlace_1 | default: 'Ver más'
        -%}

        {% if enlace_1 != blank %}
          <a
            href="{{ enlace_1 }}"
            class="enlace-imagen"
            aria-label="{{ texto_enlace_1 | escape }}"
          >
        {% endif %}

        <div class="envoltorio-imagen">
          {% comment %} Imagen para Desktop/Tablet {% endcomment %}
          {% if imagen_desktop %}
            <img
              src="{{ imagen_desktop | image_url: width: 800 }}"
              srcset="
                {{ imagen_desktop | image_url: width: 400 }} 400w,
                {{ imagen_desktop | image_url: width: 600 }} 600w,
                {{ imagen_desktop | image_url: width: 800 }} 800w,
                {{ imagen_desktop | image_url: width: 1200 }} 1200w
              "
              sizes="(max-width: 767px) 100vw, 50vw"
              alt="{{ imagen_desktop.alt | default: section.settings.alt_imagen_1 | escape }}"
              class="imagen-dual imagen-dual--desktop"
              width="{{ imagen_desktop.width }}"
              height="{{ imagen_desktop.height }}"
              loading="lazy"
            >
          {% else %}
            {% comment %} Placeholder si no hay imagen {% endcomment %}
            <div class="placeholder-imagen imagen-dual--desktop">
              <span>Imagen 1 Desktop</span>
            </div>
          {% endif %}

          {% comment %} Imagen para Mobile (solo si es diferente) {% endcomment %}
          {% if imagen_mobile and imagen_mobile.id != imagen_desktop.id %}
            <img
              src="{{ imagen_mobile | image_url: width: 600 }}"
              srcset="
                {{ imagen_mobile | image_url: width: 300 }} 300w,
                {{ imagen_mobile | image_url: width: 400 }} 400w,
                {{ imagen_mobile | image_url: width: 600 }} 600w
              "
              sizes="100vw"
              alt="{{ imagen_mobile.alt | default: section.settings.alt_imagen_1 | escape }}"
              class="imagen-dual imagen-dual--mobile"
              width="{{ imagen_mobile.width }}"
              height="{{ imagen_mobile.height }}"
              loading="lazy"
            >
          {% endif %}
        </div>

        {% if enlace_1 != blank %}
          </a>
        {% endif %}
      </div>

      {% comment %} IMAGEN 2 {% endcomment %}
      <div class="item-imagen item-imagen--2">
        {%- liquid
          # Imagen para desktop/tablet
          assign imagen_desktop_2 = section.settings.imagen_2_desktop
          # Imagen para mobile
          assign imagen_mobile_2 = section.settings.imagen_2_mobile
          # Fallback: si no hay mobile, usa desktop
          unless imagen_mobile_2
            assign imagen_mobile_2 = imagen_desktop_2
          endunless

          # Enlace opcional
          assign enlace_2 = section.settings.enlace_2
          assign texto_enlace_2 = section.settings.texto_enlace_2 | default: 'Ver más'
        -%}

        {% if enlace_2 != blank %}
          <a
            href="{{ enlace_2 }}"
            class="enlace-imagen"
            aria-label="{{ texto_enlace_2 | escape }}"
          >
        {% endif %}

        <div class="envoltorio-imagen">
          {% comment %} Imagen para Desktop/Tablet {% endcomment %}
          {% if imagen_desktop_2 %}
            <img
              src="{{ imagen_desktop_2 | image_url: width: 800 }}"
              srcset="
                {{ imagen_desktop_2 | image_url: width: 400 }} 400w,
                {{ imagen_desktop_2 | image_url: width: 600 }} 600w,
                {{ imagen_desktop_2 | image_url: width: 800 }} 800w,
                {{ imagen_desktop_2 | image_url: width: 1200 }} 1200w
              "
              sizes="(max-width: 767px) 100vw, 50vw"
              alt="{{ imagen_desktop_2.alt | default: section.settings.alt_imagen_2 | escape }}"
              class="imagen-dual imagen-dual--desktop"
              width="{{ imagen_desktop_2.width }}"
              height="{{ imagen_desktop_2.height }}"
              loading="lazy"
            >
          {% else %}
            {% comment %} Placeholder si no hay imagen {% endcomment %}
            <div class="placeholder-imagen imagen-dual--desktop">
              <span>Imagen 2 Desktop</span>
            </div>
          {% endif %}

          {% comment %} Imagen para Mobile (solo si es diferente) {% endcomment %}
          {% if imagen_mobile_2 and imagen_mobile_2.id != imagen_desktop_2.id %}
            <img
              src="{{ imagen_mobile_2 | image_url: width: 600 }}"
              srcset="
                {{ imagen_mobile_2 | image_url: width: 300 }} 300w,
                {{ imagen_mobile_2 | image_url: width: 400 }} 400w,
                {{ imagen_mobile_2 | image_url: width: 600 }} 600w
              "
              sizes="100vw"
              alt="{{ imagen_mobile_2.alt | default: section.settings.alt_imagen_2 | escape }}"
              class="imagen-dual imagen-dual--mobile"
              width="{{ imagen_mobile_2.width }}"
              height="{{ imagen_mobile_2.height }}"
              loading="lazy"
            >
          {% endif %}
        </div>

        {% if enlace_2 != blank %}
          </a>
        {% endif %}
      </div>
    </div>
  </div>
</section>

{% comment %} CSS Mejorado - Respeta max-width del proyecto {% endcomment %}
<style>
  /* ===== SECCIÓN BASE ===== */
  .seccion-imagenes-duales {
    padding-top: var(--padding-superior);
    padding-bottom: var(--padding-inferior);
    width: 100%;
  }

  /* ===== WRAPPER INTERNO ===== */
  /* Este es el que controla el layout flex */
  .imagenes-wrapper {
    display: flex;
    flex-direction: row; /* Por defecto ROW para desktop/tablet */
    gap: var(--espacio-imagenes);
    width: 100%;
  }

  /* ===== CLASE FULL-WIDTH (opcional) ===== */
  .contenedor-imagenes-duales--full-width {
    max-width: 100%;
    padding: 0;
  }

  /* ===== ITEMS DE IMAGEN ===== */
  .item-imagen {
    flex: 1;
    position: relative;
    overflow: hidden;
  }

  .envoltorio-imagen {
    width: 100%;
    height: var(--altura-desktop);
    position: relative;
    overflow: hidden;
    background: #f8f8f8; /* Color de fondo mientras carga */
  }

  /* ===== ESTILOS DE IMAGEN ===== */
  .imagen-dual {
    width: 100%;
    height: 100%;
    object-fit: cover; /* ESTIRA la imagen para llenar todo el contenedor */
    object-position: center;
    display: block;
    transition: transform 0.3s ease, filter 0.3s ease;
  }

  /* ===== CONTROL DE VISIBILIDAD POR DISPOSITIVO ===== */
  .imagen-dual--mobile {
    display: none;
  }

  .imagen-dual--desktop {
    display: block;
  }

  /* ===== PLACEHOLDERS ===== */
  .placeholder-imagen {
    width: 100%;
    height: 100%;
    background: #f5f5f5;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #666;
    font-size: 14px;
    border: 2px dashed #ddd;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  }

  /* ===== ENLACES INTERACTIVOS ===== */
  .enlace-imagen {
    display: block;
    width: 100%;
    height: 100%;
    text-decoration: none;
    position: relative;
  }

  .enlace-imagen:hover .imagen-dual {
    transform: scale(1.02);
    filter: brightness(1.05);
  }

  .enlace-imagen:focus {
    outline: 3px solid #005fcc;
    outline-offset: 2px;
  }

  /* ===== RESPONSIVE: SOLO MOBILE = COLUMN ===== */
  @media screen and (max-width: 767px) {
    .imagenes-wrapper {
      flex-direction: column; /* SOLO en mobile cambia a column */
    }

    .envoltorio-imagen {
      height: var(--altura-mobile);
    }

    /* Intercambio de imágenes en mobile */
    .imagen-dual--desktop {
      display: none;
    }

    .imagen-dual--mobile {
      display: block;
    }

    /* Si no hay imagen mobile específica, muestra la desktop */
    .item-imagen:not(:has(.imagen-dual--mobile)) .imagen-dual--desktop {
      display: block;
    }
  }

  /* ===== TABLETS - MANTIENE ROW ===== */
  @media screen and (min-width: 768px) and (max-width: 1024px) {
    .envoltorio-imagen {
      height: calc(var(--altura-desktop) * 0.85);
    }
  }

  /* ===== ACCESIBILIDAD ===== */
  @media (prefers-reduced-motion: reduce) {
    .imagen-dual {
      transition: none;
    }

    .enlace-imagen:hover .imagen-dual {
      transform: none;
      filter: none;
    }
  }

  /* ===== MEJORAS DE PERFORMANCE ===== */
  .imagen-dual {
    will-change: transform;
  }

  .enlace-imagen:not(:hover) .imagen-dual {
    will-change: auto;
  }
</style>

{% schema %}
{
  "name": "Imágenes Duales",
  "tag": "section",
  "class": "section-imagenes-duales",
  "settings": [
    {
      "type": "header",
      "content": "⚙️ Configuración General"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Ancho completo",
      "default": false,
      "info": "Activar para que ocupe todo el ancho de la pantalla (sin límite)"
    },
    {
      "type": "range",
      "id": "padding_superior",
      "label": "Espaciado superior (px)",
      "min": 0,
      "max": 120,
      "step": 10,
      "default": 40,
      "info": "Espacio arriba de toda la sección"
    },
    {
      "type": "range",
      "id": "padding_inferior",
      "label": "Espaciado inferior (px)",
      "min": 0,
      "max": 120,
      "step": 10,
      "default": 40,
      "info": "Espacio debajo de toda la sección"
    },
    {
      "type": "range",
      "id": "espacio_entre_imagenes",
      "label": "Espacio entre imágenes (px)",
      "min": 0,
      "max": 60,
      "step": 5,
      "default": 20,
      "info": "Separación entre las dos imágenes"
    },
    {
      "type": "range",
      "id": "altura_desktop",
      "label": "Altura en Desktop (px)",
      "min": 100,
      "max": 800,
      "step": 50,
      "default": 150,
      "info": "Altura de las imágenes en pantallas grandes"
    },
    {
      "type": "range",
      "id": "altura_mobile",
      "label": "Altura en Mobile (px)",
      "min": 150,
      "max": 500,
      "step": 25,
      "default": 300,
      "info": "Altura de las imágenes en móviles"
    },
    {
      "type": "header",
      "content": "🖼️ Imagen 1"
    },
    {
      "type": "image_picker",
      "id": "imagen_1_desktop",
      "label": "Imagen 1 - Desktop/Tablet",
      "info": "Recomendado: 800x400px o superior"
    },
    {
      "type": "image_picker",
      "id": "imagen_1_mobile",
      "label": "Imagen 1 - Mobile (opcional)",
      "info": "Si no seleccionas, se usará la imagen de desktop"
    },
    {
      "type": "text",
      "id": "alt_imagen_1",
      "label": "Texto alternativo imagen 1",
      "info": "Importante para SEO y accesibilidad"
    },
    {
      "type": "url",
      "id": "enlace_1",
      "label": "Enlace imagen 1 (opcional)",
      "info": "Productos: /products/nombre | Colecciones: /collections/nombre"
    },
    {
      "type": "text",
      "id": "texto_enlace_1",
      "label": "Descripción del enlace 1",
      "default": "Ver más",
      "info": "Para lectores de pantalla"
    },
    {
      "type": "header",
      "content": "🖼️ Imagen 2"
    },
    {
      "type": "image_picker",
      "id": "imagen_2_desktop",
      "label": "Imagen 2 - Desktop/Tablet",
      "info": "Recomendado: 800x400px o superior"
    },
    {
      "type": "image_picker",
      "id": "imagen_2_mobile",
      "label": "Imagen 2 - Mobile (opcional)",
      "info": "Si no seleccionas, se usará la imagen de desktop"
    },
    {
      "type": "text",
      "id": "alt_imagen_2",
      "label": "Texto alternativo imagen 2",
      "info": "Importante para SEO y accesibilidad"
    },
    {
      "type": "url",
      "id": "enlace_2",
      "label": "Enlace imagen 2 (opcional)",
      "info": "Productos: /products/nombre | Colecciones: /collections/nombre"
    },
    {
      "type": "text",
      "id": "texto_enlace_2",
      "label": "Descripción del enlace 2",
      "default": "Ver más",
      "info": "Para lectores de pantalla"
    }
  ],
  "presets": [
    {
      "name": "Imágenes Duales",
      "category": "t:sections.all.preset_category.banners"
    }
  ]
}
{% endschema %}
