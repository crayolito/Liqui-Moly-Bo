{% comment %}
  =====================================================
  SNIPPET: Card Collection Custom
  PROPÓSITO: Tarjeta de colección personalizable para secciones
  ÚLTIMA ACTUALIZACIÓN: 2025-10-10
  =====================================================

  Acepta:
  - collection: {Object} Objeto de colección
  - image: {Object} Imagen override. Opcional.
  - title: {String} Título override. Opcional.
  - description: {String} Descripción override. Opcional.
  - button_text: {String} Texto del botón override. Opcional.
  - class: {String} Clases CSS extra. Opcional
  - settings: {Object} Configuraciones de la tarjeta
{% endcomment %}

{%- liquid
  # Determinar si toda la tarjeta debe ser clicable
  assign full_card_clickable = false
  if settings.hide_collection_button == true
    assign full_card_clickable = true
  endif
-%}

<div class="card-overlay {% unless overlay == false %}card-overlay-on{% else %}card-overlay-off{% endunless %} {{ class }} {% if full_card_clickable %}card-overlay-full-clickable{% endif %}">
  {% comment %} Contenedor de imagen con enlace {% endcomment %}
  <a href="{{ collection.url }}" class="card-overlay-link-wrapper">
    {% if image != blank %}
      {{
        image
        | image_url: width: 1420
        | image_tag:
          class: 'card-overlay-media',
          widths: '165, 440, 650, 850, 1100, 1200, 1420',
          sizes: '(min-width: 1200px) calc((100vw - 6rem) / 2), (min-width: 990px) calc((100vw - 6rem) * 0.6), (min-width: 750px) calc(100vw - 4rem), calc(100vw - 3rem)'
      }}
    {% elsif collection.featured_image %}
      {{
        collection.featured_image
        | image_url: width: 1420
        | image_tag:
          class: 'card-overlay-media',
          widths: '165, 440, 650, 850, 1100, 1200, 1420',
          sizes: '(min-width: 1200px) calc((100vw - 6rem) / 2), (min-width: 990px) calc((100vw - 6rem) * 0.6), (min-width: 750px) calc(100vw - 4rem), calc(100vw - 3rem)'
      }}
    {% else %}
      {{ 'collection-1' | strip | placeholder_svg_tag: 'card-overlay-media' }}
    {% endif %}

    <span class="visually-hidden">
      {% if title != blank %}
        {{ title }}
      {% elsif collection.title != blank %}
        {{ collection.title }}
      {% else %}
        {{ 'onboarding.collection_title' | t }}
      {% endif %}
    </span>
  </a>

  {% comment %} Información de la tarjeta (título, descripción, botón) {% endcomment %}
  <div class="card-overlay-info {% if settings.collection_box_align != blank %}content-align-{{ settings.collection_box_align }}{% endif %}">
    {% unless settings.hide_collection_title == true %}
      <h3 class="card-overlay-heading">
        {% if title != blank %}
          <a href="{{ collection.url }}">{{ title }}</a>
        {% elsif collection.title != blank %}
          <a href="{{ collection.url }}">{{ collection.title }}</a>
        {% else %}
          {{ 'onboarding.collection_title' | t }}
        {% endif %}
      </h3>
    {% endunless %}

    {% unless description == blank
      and collection.description == blank
      or settings.hide_collection_description == true
    %}
      <div class="card-overlay-caption card-overlay-caption-truncate">
        {% if description != blank %}
          {{ description }}
        {% else %}
          {{ collection.description }}
        {% endif %}
      </div>
    {% endunless %}

    {% unless settings.hide_collection_button == true %}
      <a
        class="button color-button-{{ settings.collection_button_color_scheme }}"
        {% if collection.url == blank %}
          role="link" aria-disabled="true"
        {% else %}
          href="{{ collection.url }}"
        {% endif %}
      >
        {% if button_text != blank %}
          {{ button_text }}
        {% else %}
          {{ 'general.collection.shop_collection' | t: title: collection.title }}
        {% endif %}
      </a>
    {% endunless %}
  </div>
</div>
